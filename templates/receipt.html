{% extends "base.html" %}

{% block title %}Receipt #{{ payment.receipt_number if payment and payment.receipt_number else 'N/A' }}{% endblock %}

{% block extra_css %}
<style>
    /* [Previous CSS remains exactly the same] */
</style>
{% endblock %}

{% block content %}
<div class="receipt-container">
    <!-- Header Section -->
    <div class="receipt-header">
        {% if logo_base64 %}
        <img src="data:image/png;base64,{{ logo_base64 }}" class="receipt-logo" alt="School Logo">
        {% endif %}
        <div class="receipt-title">ST PAUL RONGO DAY SECONDARY SCHOOL</div>
        <div class="receipt-subtitle">SCHOOL FEES PAYMENT RECEIPT</div>
    </div>
    
    <!-- Transaction Details -->
    <div class="receipt-details">
        <div>
            <strong>Receipt No:</strong> {{ payment.receipt_number if payment and payment.receipt_number else 'N/A' }}<br>
            <strong>Date:</strong> 
            {% if payment and payment.payment_date %}
                {{ payment.payment_date.strftime('%d/%m/%Y') }}
            {% else %}
                N/A
            {% endif %}<br>
            <strong>Time:</strong> {{ current_time.split(' ')[1] if current_time else 'N/A' }}
        </div>
        <div class="text-right">
            <strong>Student:</strong> {{ payment.student_name if payment and payment.student_name else 'N/A' }}<br>
            <strong>Adm No:</strong> {{ payment.admission_no if payment and payment.admission_no else 'N/A' }}<br>
            <strong>Form:</strong> {{ payment.form if payment and payment.form else 'N/A' }}
        </div>
    </div>
    
    <!-- Payment Breakdown -->
    <table class="receipt-table">
        <thead>
            <tr>
                <th>Description</th>
                <th class="text-right">Amount (KSh)</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Payment for {{ payment.term_name if payment and payment.term_name else 'Term Payment' }}</td>
                <td class="text-right">
                    {% if payment and payment.amount_paid is not none %}
                        KSh{{ "{:,.2f}".format(payment.amount_paid) }}
                    {% else %}
                        KSh0.00
                    {% endif %}
                </td>
            </tr>
            <tr>
                <td class="text-right"><strong>Total Paid:</strong></td>
                <td class="text-right">
                    <strong>
                        {% if payment and payment.amount_paid is not none %}
                            KSh{{ "{:,.2f}".format(payment.amount_paid) }}
                        {% else %}
                            KSh0.00
                        {% endif %}
                    </strong>
                </td>
            </tr>
            <tr class="balance-row">
                <td class="text-right"><strong>Balance:</strong></td>
                <td class="text-right">
                    <strong>
                        {% if outstanding_balance is not none %}
                            KSh{{ "{:,.2f}".format(outstanding_balance) }}
                        {% else %}
                            KSh0.00
                        {% endif %}
                    </strong>
                </td>
            </tr>
        </tbody>
    </table>
    
    <!-- [Rest of the template remains the same] -->
</div>

<!-- [Print controls remain the same] -->
{% endblock %}
