{% extends 'base.html' %}

{% block content %}
<h2 class="mb-4">Payments</h2>

<!-- Add Payment Form -->
<form method="POST" action="{{ url_for('add_payment') }}" class="row g-2 mb-5">
  <div class="col-md-3">
    <input name="admission_no" type="text" class="form-control" placeholder="Admission No" required>
  </div>
  <div class="col-md-3">
    <input name="student_name" type="text" class="form-control" placeholder="Student Name" required>
  </div>
  <div class="col-md-2">
    <input name="term_name" type="text" class="form-control" placeholder="Term (e.g., Term 1)" required>
  </div>
  <div class="col-md-2">
    <input name="amount_paid" type="number" step="0.01" class="form-control" placeholder="Amount Paid" required>
  </div>
  <div class="col-md-2">
    <input name="payment_date" type="date" class="form-control" required>
  </div>
  <div class="col-12 mt-2">
    <button type="submit" class="btn btn-success">Add Payment</button>
  </div>
</form>

<!-- Payments Table -->
<table class="table table-striped table-bordered">
  <thead class="table-primary">
    <tr>
      <th>Admission No</th>
      <th>Student</th>
      <th>Term</th>
      <th>Amount</th>
      <th>Date</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for payment in payments %}
    <tr>
      <form method="POST" action="{{ url_for('edit_payment', id=payment.id) }}">
        <td>{{ payment.admission_no }}</td>
        <td>
          <input type="text" name="student_name" value="{{ payment.student_name }}" class="form-control" readonly>
        </td>
        <td>
          <input type="text" name="term_name" value="{{ payment.term_name }}" class="form-control" readonly>
        </td>
        <td>
          <input type="number" name="amount_paid" value="{{ payment.amount_paid }}" step="0.01" class="form-control">
        </td>
        <td>
          <input type="date" name="payment_date" value="{{ payment.payment_date }}" class="form-control">
        </td>
        <td>
          <button type="submit" class="btn btn-warning btn-sm">Save</button>
      </form>
      <form method="POST" action="{{ url_for('delete_payment', id=payment.id) }}" class="d-inline">
        <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Delete this payment?')">Delete</button>
        <a class="btn btn-info btn-sm" href="{{ url_for('view_receipt', payment_id=payment.id) }}" target="_blank">Receipt</a>
      </form>
        </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
